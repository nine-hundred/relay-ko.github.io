<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Type Emission · Relay</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="As part of its normal work, `relay-compiler` will emit type information for your language of choice that helps you write type-safe application code. These types are included in the artifacts that `relay-compiler` generates to describe your operations and fragments."/><meta name="docsearch:version" content="v6.0.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Type Emission · Relay"/><meta property="og:type" content="website"/><meta property="og:url" content="https://relay.dev/"/><meta property="og:description" content="As part of its normal work, `relay-compiler` will emit type information for your language of choice that helps you write type-safe application code. These types are included in the artifacts that `relay-compiler` generates to describe your operations and fragments."/><meta property="og:image" content="https://relay.dev/img/relay.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://relay.dev/img/relay.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="/js/redirect.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><h2 class="headerTitle">Relay</h2></a><a href="/versions"><h3>v6.0.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/v6.0.0/introduction-to-relay" target="_self">문서</a></li><li class=""><a href="/help" target="_self">도움</a></li><li class=""><a href="https://github.com/facebook/relay" target="_self">GitHub</a></li><li class=""><a href="https://github.com/relay-ko/relay-ko.github.io" target="_self">🇰🇷한국어 번역</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>가이드</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">시작하기<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/introduction-to-relay">Introduction to Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/installation-and-setup">Installation and Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/quick-start-guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API 레퍼런스<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/graphql-in-relay">GraphQL in Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/relay-environment">Relay Environment</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/network-layer">Network Layer</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/query-renderer">QueryRenderer</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/fragment-container">Fragment Container</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/refetch-container">Refetch Container</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/pagination-container">Pagination Container</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/mutations">Mutations</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/subscriptions">Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/relay-store">Relay Store</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/fetch-query">fetchQuery</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">가이드<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/routing">Routing</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/relay-debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/graphql-server-specification">GraphQL Server Specification</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/persisted-queries">Persisted Queries</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/v6.0.0/type-emission">Type Emission</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/testing-relay-components">Testing Relay Components</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/local-state-management">Local State Management</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">원칙과 설계<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/thinking-in-graphql">Thinking in GraphQL</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/thinking-in-relay">Thinking In Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/architecture-overview">Architecture Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/compiler-architecture">Compiler Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/runtime-architecture">Runtime Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/videos">Videos</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">커뮤니티<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/v6.0.0/community-learning-resources">Community Learning Resources</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/relay-ko/relay-ko.github.io/edit/develop/docs/Modern-TypeEmission.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Type Emission</h1></header><article><div><span><p>As part of its normal work, <code>relay-compiler</code> will emit type information for your language of choice that helps you write type-safe application code. These types are included in the artifacts that <code>relay-compiler</code> generates to describe your operations and fragments.</p>
<p>Regardless of your choice of language, all language plugins will emit roughly the same sort of type-information, but be sure to read the documentation for other <a href="#language-plugins">language plugins</a> to learn about their specifics.</p>
<h3><a class="anchor" aria-hidden="true" id="operation-input-data"></a><a href="#operation-input-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Operation input data</h3>
<p>The shape of the variables object used for query, mutation, or subscription operations.</p>
<p>In this example the emitted type-information would require the variables object to contain a <code>page</code> key with a non-null string.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-61-tab-62" class="nav-link active" data-group="group_61" data-tab="tab-group-61-content-62">Flow</div><div id="tab-group-61-tab-63" class="nav-link" data-group="group_61" data-tab="tab-group-61-content-63">TypeScript</div></div><div class="tab-content"><div id="tab-group-61-content-62" class="tab-pane active" data-group="group_61" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * export type ExampleQueryVariables = {|<br /> *   +artistID: string<br /> * |}<br /> */</span><br /><span class="hljs-keyword">import</span> type { ExampleQueryVariables } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleQuery.graphql"</span><br /><br /><span class="hljs-keyword">const</span> variables: ExampleQueryVariables = {<br />  <span class="hljs-attr">artistID</span>: <span class="hljs-string">'banksy'</span>,<br />}<br /><br />&lt;QueryRenderer<br />  query={graphql<span class="hljs-string">`<br />    query ExampleQuery($artistID: ID!) {<br />      artist(id: $artistID) {<br />        name<br />      }<br />    }<br />  `</span>}<br />  variables={variables}<br />/&gt;<br /></code></pre>
</span></div></div><div id="tab-group-61-content-63" class="tab-pane" data-group="group_61" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * export type ExampleQueryVariables = {<br /> *   readonly artistID: string<br /> * }<br /> * export type ExampleQuery = {<br /> *   readonly variables: ExampleQueryVariables<br /> * }<br /> */</span><br /><span class="hljs-keyword">import</span> { ExampleQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleQuery.graphql"</span><br /><br />&lt;QueryRenderer&lt;ExampleQuery&gt;<br />  query={graphql<span class="hljs-string">`<br />    query ExampleQuery($artistID: ID!) {<br />      artist(id: $artistID) {<br />        name<br />      }<br />    }<br />  `</span>}<br />  variables={{<br />    <span class="hljs-attr">artistID</span>: <span class="hljs-string">'banksy'</span>,<br />  }}<br />/&gt;<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="operation-fragment-selection-set-data"></a><a href="#operation-fragment-selection-set-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Operation/Fragment selection-set data</h3>
<p>The shape of the data selected in a operation or fragment, following the <a href="./thinking-in-relay.html#data-masking">data-masking</a> rules. That is, excluding any data selected by fragment spreads, unless the <code>@relay(mask: false)</code> directive is used.</p>
<p>In this example the emitted type-information describes the response data available to the operation’s render function.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-64-tab-65" class="nav-link active" data-group="group_64" data-tab="tab-group-64-content-65">Flow</div><div id="tab-group-64-tab-66" class="nav-link" data-group="group_64" data-tab="tab-group-64-content-66">TypeScript</div></div><div class="tab-content"><div id="tab-group-64-content-65" class="tab-pane active" data-group="group_64" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * export type ExampleQueryResponse = {|<br /> *   +artist: ?{|<br /> *     +name: string<br /> *   |}<br /> * |}<br /> */</span><br /><span class="hljs-keyword">import</span> type { ExampleQueryResponse } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleQuery.graphql"</span><br /><br />&lt;QueryRenderer<br />  query={graphql<span class="hljs-string">`<br />    query ExampleQuery {<br />      artist(id: "banksy") {<br />        name<br />      }<br />    }<br />  `</span>}<br />  render={({ props }: { props?: ExampleQueryResponse }) =&gt; {<br />    <span class="hljs-keyword">if</span> (props) {<br />      <span class="hljs-keyword">return</span> props.artist &amp;&amp; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{props.artist.name} is great!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br />    }<br />    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br />  }}<br />/&gt;<br /></code></pre>
</span></div></div><div id="tab-group-64-content-66" class="tab-pane" data-group="group_64" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * export type ExampleQueryResponse = {<br /> *   readonly artist?: {<br /> *     readonly name: string<br /> *   }<br /> * }<br /> * export type ExampleQuery = {<br /> *   readonly response: ExampleQueryResponse<br /> * }<br /> */</span><br /><span class="hljs-keyword">import</span> { ExampleQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleQuery.graphql"</span><br /><br />&lt;QueryRenderer&lt;ExampleQuery&gt;<br />  query={graphql<span class="hljs-string">`<br />    query ExampleQuery {<br />      artist(id: "banksy") {<br />        name<br />      }<br />    }<br />  `</span>}<br />  render={({ props }) =&gt; {<br />    <span class="hljs-keyword">if</span> (props) {<br />      <span class="hljs-keyword">return</span> props.artist &amp;&amp; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{props.artist.name} is great!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br />    }<br />    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br />  }}<br />/&gt;<br /></code></pre>
</span></div></div></div></div>
<p>Similarly, in this example the emitted type-information describes the prop data that the container expects to receive.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-67-tab-68" class="nav-link active" data-group="group_67" data-tab="tab-group-67-content-68">Flow</div><div id="tab-group-67-tab-69" class="nav-link" data-group="group_67" data-tab="tab-group-67-content-69">TypeScript</div></div><div class="tab-content"><div id="tab-group-67-content-68" class="tab-pane active" data-group="group_67" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * export type ExampleFragment_artist = {|<br /> *   +name: string<br /> * |}<br /> */</span><br /><span class="hljs-keyword">import</span> type { ExampleFragment_artist } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleFragment_artist.graphql"</span><br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> ExampleFragment = createFragmentContainer(<br />  <span class="hljs-function">(<span class="hljs-params">props: { artist: ExampleFragment_artist }</span>) =&gt;</span> (<br />    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>About the artist: {props.artist.biography}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br />  ),<br />  {<br />    <span class="hljs-attr">artist</span>: graphql<span class="hljs-string">`<br />      fragment ExampleFragment_artist on Artist {<br />        biography<br />      }<br />    `</span><br />  }<br />)<br /></code></pre>
</span></div></div><div id="tab-group-67-content-69" class="tab-pane" data-group="group_67" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * export type ExampleFragment_artist = {<br /> *   readonly name: string<br /> * }<br /> */</span><br /><span class="hljs-keyword">import</span> { ExampleFragment_artist } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleFragment_artist.graphql"</span><br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> ExampleFragment = createFragmentContainer(<br />  <span class="hljs-function">(<span class="hljs-params">props: { artist: ExampleFragment_artist }</span>) =&gt;</span> (<br />    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>About the artist: {props.artist.biography}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br />  ),<br />  {<br />    <span class="hljs-attr">artist</span>: graphql<span class="hljs-string">`<br />      fragment ExampleFragment_artist on Artist {<br />        biography<br />      }<br />    `</span>,<br />  }<br />)<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="fragment-references"></a><a href="#fragment-references" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fragment references</h3>
<p>The opaque identifier described in <a href="./thinking-in-relay.html#data-masking">data-masking</a> that a child container expects to receive from its parent, which represents the child container’s fragment spread inside the parent’s fragment.</p>
<p><em>Please read <a href="#single-artifact-directory">this important caveat</a> about actually enabling type-safe fragment reference checking.</em></p>
<p>Consider a component that composes the above fragment container example. In this example, the emitted type-information of the child container receives a unique opaque identifier type, called a fragment reference, which the type-information emitted for the parent’s fragment references in the location where the child’s fragment is spread. Thus ensuring that the child’s fragment is spread into the parent’s fragment <em>and</em> the correct fragment reference is passed to the child container at runtime.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-70-tab-71" class="nav-link active" data-group="group_70" data-tab="tab-group-70-content-71">Flow</div><div id="tab-group-70-tab-72" class="nav-link" data-group="group_70" data-tab="tab-group-70-content-72">TypeScript</div></div><div class="tab-content"><div id="tab-group-70-content-71" class="tab-pane active" data-group="group_70" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * import type { FragmentReference } from "relay-runtime";<br /> * declare export opaque type ExampleFragment_artist$ref: FragmentReference;<br /> * export type ExampleFragment_artist = {|<br /> *   +name: string,<br /> *   +$refType: ExampleFragment_artist$ref,<br /> * |};<br /> */</span><br /><span class="hljs-keyword">import</span> { ExampleFragment } <span class="hljs-keyword">from</span> <span class="hljs-string">"./ExampleFragment"</span><br /><br /><span class="hljs-comment">/**<br /> * import type { ExampleFragment_artist$ref } from "ExampleFragment_artist.graphql";<br /> * export type ExampleQueryResponse = {|<br /> *   +artist: ?{|<br /> *     +$fragmentRefs: ExampleFragment_artist$ref,<br /> *   |}<br /> * |};<br /> */</span><br /><span class="hljs-keyword">import</span> type { ExampleQueryResponse } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleQuery.graphql"</span><br /><br />&lt;QueryRenderer<br />  query={graphql<span class="hljs-string">`<br />    query ExampleQuery {<br />      artist(id: "banksy") {<br />        ...ExampleFragment_artist<br />      }<br />    }<br />  `</span>}<br />  render={({ props }: { props?: ExampleQueryResponse }) =&gt; {<br />    <span class="hljs-keyword">if</span> (props) {<br />      <span class="hljs-comment">// Here only `props.artist` is an object typed as the appropriate prop</span><br />      <span class="hljs-comment">// for the `artist` prop of the `ExampleFragment` container.</span><br />      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ExampleFragment</span> <span class="hljs-attr">artist</span>=<span class="hljs-string">{props.artist}</span> /&gt;</span><br />    }<br />    return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br />  }}<br />/&gt;<br /></span></code></pre>
</span></div></div><div id="tab-group-70-content-72" class="tab-pane" data-group="group_70" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">/**<br /> * declare const _ExampleFragment_artist$ref: unique symbol;<br /> * export type ExampleFragment_artist$ref = typeof _ExampleFragment_artist$ref;<br /> * export type ExampleFragment_artist = {<br /> *   readonly name: string<br /> *   readonly " $refType": ExampleFragment_artist$ref<br /> * }<br /> */</span><br /><span class="hljs-keyword">import</span> { ExampleFragment } <span class="hljs-keyword">from</span> <span class="hljs-string">"./ExampleFragment"</span><br /><br /><span class="hljs-comment">/**<br /> * import { ExampleFragment_artist$ref } from "ExampleFragment_artist.graphql";<br /> * export type ExampleQueryResponse = {<br /> *   readonly artist?: {<br /> *     readonly " $fragmentRefs": ExampleFragment_artist$ref<br /> *   }<br /> * }<br /> * export type ExampleQuery = {<br /> *   readonly response: ExampleQueryResponse<br /> * }<br /> */</span><br /><span class="hljs-keyword">import</span> { ExampleQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">"__generated__/ExampleQuery.graphql"</span><br /><br />&lt;QueryRenderer&lt;ExampleQuery&gt;<br />  query={graphql<span class="hljs-string">`<br />    query ExampleQuery {<br />      artist(id: "banksy") {<br />        ...ExampleFragment_artist<br />      }<br />    }<br />  `</span>}<br />  render={({ props }) =&gt; {<br />    <span class="hljs-keyword">if</span> (props) {<br />      <span class="hljs-comment">// Here only `props.artist` is an object typed as the appropriate prop</span><br />      <span class="hljs-comment">// for the `artist` prop of the `ExampleFragment` container.</span><br />      <span class="hljs-keyword">return</span> props.artist &amp;&amp; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ExampleFragment</span> <span class="hljs-attr">artist</span>=<span class="hljs-string">{props.artist}</span> /&gt;</span><br />    }<br />    return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br />  }}<br />/&gt;<br /></span></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="single-artifact-directory"></a><a href="#single-artifact-directory" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Single artifact directory</h2>
<p>An important caveat to note is that by default strict fragment reference type-information will <em>not</em> be emitted, instead they will be typed as <code>any</code> and would allow you to pass in any data to the child container.</p>
<p>To enable this feature, you will have to tell the compiler to store all the artifacts in a single directory, like so:</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> relay-compiler --artifactDirectory ./src/__generated__ […]</span>
</code></pre>
<p>…and additionally inform the babel plugin in your <code>.babelrc</code> config where to look for the artifacts:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"plugins"</span>: [
    [<span class="hljs-string">"relay"</span>, { <span class="hljs-attr">"artifactDirectory"</span>: <span class="hljs-string">"./src/__generated__"</span> }]
  ]
}
</code></pre>
<p>It is recommended to alias this directory in your module resolution configuration such that you don’t need to specify relative paths in your source files. This is what is also done in the above examples, where artifacts are imported from a <code>__generated__</code> alias, rather than relative paths like <code>../../../../__generated__</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="background-information"></a><a href="#background-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Background information</h3>
<p>The reason is that <code>relay-compiler</code> and its artifact emission is stateless. Meaning that it does not keep track of locations of original source files and where the compiler previously saved the accompanying artifact on disk. Thus, if the compiler were to emit artifacts that try to import fragment reference types from <em>other</em> artifacts, the compiler would:</p>
<ul>
<li>first need to know where on disk that other artifact exists;</li>
<li>and update imports when the other artifact changes location on disk.</li>
</ul>
<p>Facebook uses a module system called <a href="https://twitter.com/dan_abramov/status/758655309212704768">Haste</a>, in which all source files are considered in a flat namespace. This means that an import declaration does not need to specify the path to another module and thus there is no need for the compiler to ever consider the above issues. I.e. an import only needs to specify the basename of the module filename and Haste takes care of actually finding the right module at import time. Outside of Facebook, however, usage of the Haste module system is non-existent nor encouraged, thus the decision to not import fragment reference types but instead type them as <code>any</code>.</p>
<p>At its simplest, we can consider Haste as a single directory that contains all module files, thus all module imports always being safe to import using relative sibling paths. This is what is achieved by the single artifact directory feature. Rather than co-locating artifacts with their source files, all artifacts are stored in a single directory, allowing the compiler to emit imports of fragment reference types.</p>
<h2><a class="anchor" aria-hidden="true" id="language-plugins"></a><a href="#language-plugins" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Language plugins</h2>
<ul>
<li><p>Flow: This is the default and builtin language plugin. You can explicitly enable it like so:</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> relay-compiler --language javascript […]</span>
</code></pre></li>
</ul>
<p>By default, Flow types are emitted inside of comments to avoid forcing your project to use Flow. Flow types inside of comments is perfectly valid Flow, however, some editors and IDEs (like WebStorm/IDEA) do not understand Flow unless it's in plain source code. In order to solve that, there's a language plugin maintained by the community that replicates the functionality of the default builtin plugin, but emits the Flow types as plain source and not inside comments. Installation and usage:</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">  $</span><span class="bash"> yarn add --dev relay-compiler-language-js-flow-uncommented</span>
<span class="hljs-meta">  $</span><span class="bash"> relay-compiler --language js-flow-uncommented […]</span>
</code></pre>
<ul>
<li><p><a href="https://github.com/relay-tools/relay-compiler-language-typescript">TypeScript</a>: This is a language plugin for the TypeScript language maintained by the community. Install and enable it like so:</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">$</span><span class="bash"> yarn add --dev relay-compiler-language-typescript @types/react-relay @types/relay-runtime</span>
<span class="hljs-meta">$</span><span class="bash"> relay-compiler --language typescript […]</span>
</code></pre></li>
</ul>
<p>If you are looking to create your own language plugin, refer to the <code>relay-compiler</code> <a href="https://github.com/facebook/relay/blob/master/packages/relay-compiler/language/RelayLanguagePluginInterface.js">language plugin interface</a>.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2020. 2. 3. by Tony</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/v6.0.0/persisted-queries"><span class="arrow-prev">← </span><span>Persisted Queries</span></a><a class="docs-next button" href="/docs/v6.0.0/testing-relay-components"><span>Testing Relay Components</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#single-artifact-directory">Single artifact directory</a><ul class="toc-headings"><li><a href="#background-information">Background information</a></li></ul></li><li><a href="#language-plugins">Language plugins</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/relay.svg" alt="Relay" width="66" height="58"/></a><div><h5>문서</h5><a href="/docs/introduction-to-relay.html">시작하기</a></div><div><h5>커뮤니티</h5><a href="/users.html">유저 Showcase</a></div><div><h5>더 보기</h5><a href="https://github.com/facebook/relay">GitHub</a><a class="github-button" href="https://github.com/facebook/relay" data-icon="octicon-star" data-count-href="/facebook/relay/stargazers" data-count-api="/repos/facebook/relay#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2022 Facebook Inc. / Translated by Tony (@tonyfromundefined)</section></footer></div></body></html>